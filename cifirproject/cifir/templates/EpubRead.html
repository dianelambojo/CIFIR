{% extends "base.html" %} {% load static %} {% block extrascriptheader %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.5/jszip.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/epubjs/dist/epub.min.js"></script>
{% endblock extrascriptheader %} {% block content %}
<div class="container-fluid">
  <div class="card">
    <div class="card-header"><i class="far fa-bookmark"></i> Bookmarks</div>
    <div class="card-body">
      <div id="title"><input type="file" id="input" /></div>
      <div id="viewer" class="continuous" style="overflow: hidden"></div>
      <!-- <a id="prev" href="#prev" class="arrow">‹</a>
      <a id="next" href="#next" class="arrow">›</a> -->
    </div>
  </div>
</div>
{% endblock content %} {% block extrascriptfooter %}
<script>
  var book = ePub();
  var rendition;

  var inputElement = document.getElementById("input");

  inputElement.addEventListener("change", function (e) {
    var file = e.target.files[0];
    if (window.FileReader) {
      var reader = new FileReader();
      reader.onload = openBook;
      reader.readAsArrayBuffer(file);
    }
  });

  function openBook(e) {
    var bookData = e.target.result;
    var title = document.getElementById("title");
    // var next = document.getElementById("next");
    // var prev = document.getElementById("prev");

    book.open(bookData, "binary");
    // document.getElementById("viewer").innerHTML = "";

    rendition = book.renderTo("viewer", {
      manager: "continuous",
      flow: "scrolled",
      width: "100%",
      height: "100%",
    });

    rendition.display();

    // var keyListener = function (e) {
    //   // Left Key
    //   if ((e.keyCode || e.which) == 37) {
    //     rendition.prev();
    //   }

    //   // Right Key
    //   if ((e.keyCode || e.which) == 39) {
    //     rendition.next();
    //   }
    // };

    // rendition.on("keyup", keyListener);
    // rendition.on("relocated", function (location) {
    //   console.log(location);
    // });

    // next.addEventListener(
    //   "click",
    //   function (e) {
    //     rendition.next();
    //     e.preventDefault();
    //   },
    //   false
    // );

    // prev.addEventListener(
    //   "click",
    //   function (e) {
    //     rendition.destroy();
    //     book.destroy();
    //     book = new ePub();
    //     // rendition.prev();
    //     e.preventDefault();
    //   },
    //   false
    // );

    // document.addEventListener("keyup", keyListener, false);
  }
</script>
{% endblock extrascriptfooter %}
