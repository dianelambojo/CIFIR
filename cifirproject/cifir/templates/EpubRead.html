{% extends "base.html" %} {% load static %} {% block extrascriptheader %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.5/jszip.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/epubjs/dist/epub.min.js"></script>

<link rel="stylesheet" href="/static/css/epub.css" />
{% endblock extrascriptheader %} {% block content %}
<div class="container-fluid">
  <div class="card">
    <div class="card-header"><i class="far fa-bookmark"></i> Book </div>
    <div class="card-body">
      <div id="title"><input type="file" id="input" /></div>
      <div>
        {% for book in books %}
              {{ book.file }}
        {% endfor %}
      </div>
      <div id="viewer" class="continuous" style="overflow: hidden"></div>
    </div>
  </div>
</div>
{% endblock content %} {% block extrascriptfooter %}
<script>
  document.onload = function (e) {
    var book = ePub();
    var rendition;

    var inputElement = document.getElementById("input");

    inputElement.addEventListener("change", function (e) {
      var file = e.target.files[0];
      if (window.FileReader) {
        var reader = new FileReader();
        reader.onload = openBook;
        reader.readAsArrayBuffer(file);
      }
    });

    function openBook(e) {
      var bookData = e.target.result;
      var title = document.getElementById("title");

      book.open(bookData, "binary");
      // document.getElementById("viewer").innerHTML = "";

      rendition = book.renderTo("viewer", {
        manager: "continuous",
        flow: "scrolled",
        width: "100%",
        height: "100%",
      });

      rendition.display();
    }
  };
</script>
{% endblock extrascriptfooter %}
